<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PNE PORTAL - Cashbill System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
        }
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            background-color: white;
        }
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .login-header h2 {
            color: var(--primary-color);
            font-weight: 600;
        }
        .portal-container {
            display: none;
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: -250px;
            width: 250px;
            height: 100vh;
            background-color: var(--primary-color);
            transition: all 0.3s ease;
            z-index: 1000;
            padding-top: 60px;
            overflow-y: auto;
        }
        .sidebar.active {
            left: 0;
        }
        .sidebar-header {
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.1);
            color: white;
            font-weight: 600;
            text-align: center;
        }
        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .sidebar-menu li {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .sidebar-menu li a {
            display: block;
            padding: 15px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .sidebar-menu li a:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }
        .sidebar-menu li a.active {
            background-color: var(--secondary-color);
            color: white;
        }
        .sidebar-menu li a i {
            margin-right: 10px;
        }
        .main-content {
            margin-left: 0;
            transition: all 0.3s ease;
            min-height: 100vh;
        }
        .main-content.shifted {
            margin-left: 250px;
        }
        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .navbar-brand {
            font-weight: 600;
        }
        .content-section {
            display: none;
            padding: 20px;
        }
        .content-section.active {
            display: block;
        }
        .card {
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            border: none;
        }
        .card-header {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            border-radius: 10px 10px 0 0 !important;
            padding: 15px;
        }
        .btn-primary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        .btn-primary:hover {
            background-color: #2980b9;
            border-color: #2980b9;
        }
        .table {
            border-radius: 10px;
            overflow: hidden;
        }
        .table thead {
            background-color: var(--primary-color);
            color: white;
        }
        .product-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        .product-item:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .product-name {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        .price-tag {
            font-weight: 600;
            color: var(--danger-color);
        }
        .member-price {
            color: var(--success-color);
        }
        .min-order {
            font-size: 0.85rem;
            color: #6c757d;
        }
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
        }
        .status-badge {
            font-size: 0.75rem;
            padding: 5px 10px;
            border-radius: 20px;
        }
        .status-pending {
            background-color: var(--warning-color);
            color: white;
        }
        .status-approved {
            background-color: var(--success-color);
            color: white;
        }
        .status-committed {
            background-color: var(--secondary-color);
            color: white;
        }
        .status-draft {
            background-color: #6c757d;
            color: white;
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }
        .overlay.active {
            display: block;
        }
        .user-role {
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 4px;
            margin-left: 10px;
        }
        .role-admin {
            background-color: var(--danger-color);
            color: white;
        }
        .role-staff {
            background-color: var(--secondary-color);
            color: white;
        }
        .cashbill-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .cashbill-item:last-child {
            border-bottom: none;
        }
        .item-actions {
            display: flex;
            gap: 5px;
        }
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            line-height: 1.5;
            border-radius: 0.2rem;
        }
        .uncommitted-card {
            border-left: 4px solid var(--warning-color);
        }
        .uncommitted-card .card-header {
            background-color: var(--warning-color);
        }
        .action-buttons {
            display: flex;
            gap: 5px;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
        <div class="login-header">
            <h2><i class="fas fa-file-invoice-dollar"></i> PNE PORTAL</h2>
            <p class="text-muted">Cashbill Management System</p>
        </div>
        <form id="loginForm">
            <div class="mb-3">
                <label for="username" class="form-label">Staff ID</label>
                <input type="text" class="form-control" id="username" required>
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="password" class="form-control" id="password" required>
            </div>
            <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="rememberMe">
                <label class="form-check-label" for="rememberMe">Remember me</label>
            </div>
            <button type="submit" class="btn btn-primary w-100">Login</button>
            <div class="mt-3 text-center">
                <small class="text-muted">Demo: Admin (0000/Dd123) or Crew (0001/1234)</small>
            </div>
        </form>
    </div>
    <!-- Portal Container -->
    <div id="portalContainer" class="portal-container">
        <!-- Overlay for sidebar -->
        <div id="overlay" class="overlay"></div>
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar">
            <div class="sidebar-header">
                PNE PORTAL
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="menu-link active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="#" class="menu-link" data-section="cashbill"><i class="fas fa-file-invoice-dollar"></i> Cashbill</a></li>
                <li><a href="#" class="menu-link" data-section="logbook"><i class="fas fa-book"></i> Courier Logbook</a></li>
                <li><a href="#" class="menu-link" data-section="products"><i class="fas fa-box"></i> Products</a></li>
                <li><a href="#" class="menu-link admin-only" data-section="uncommitted"><i class="fas fa-clipboard-list"></i> Uncommitted Requests</a></li>
                <li><a href="#" class="menu-link admin-only" data-section="staff"><i class="fas fa-users"></i> Staff Management</a></li>
                <li><a href="#" class="menu-link" data-section="reports"><i class="fas fa-chart-bar"></i> Reports</a></li>
                <li><a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
        </div>
        <!-- Main Content -->
        <div id="mainContent" class="main-content">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg navbar-dark">
                <div class="container-fluid">
                    <button id="menuToggle" class="btn btn-sm btn-outline-light">
                        <i class="fas fa-bars"></i>
                    </button>
                    <a class="navbar-brand ms-2" href="#">PNE PORTAL</a>
                    <div class="ms-auto d-flex align-items-center">
                        <span id="userInfo" class="text-white me-3">
                            Welcome, <span id="userName">User</span>
                            <span id="userRole" class="user-role">Staff</span>
                        </span>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-outline-light dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user-circle"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                <li><a class="dropdown-item" href="#"><i class="fas fa-user-cog me-2"></i> Profile</a></li>
                                <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i> Settings</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" id="logoutBtn2"><i class="fas fa-sign-out-alt me-2"></i> Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </nav>
            <!-- Dashboard Section -->
            <div id="dashboard" class="content-section active">
                <div class="container-fluid">
                    <h2 class="mb-4">Dashboard</h2>
                    
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card text-white bg-primary">
                                <div class="card-body">
                                    <h5 class="card-title">Total Cashbills</h5>
                                    <h2 id="totalCashbills">24</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white bg-success">
                                <div class="card-body">
                                    <h5 class="card-title">Completed</h5>
                                    <h2 id="completedCashbills">18</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white bg-warning">
                                <div class="card-body">
                                    <h5 class="card-title">Pending Approval</h5>
                                    <h2 id="pendingCashbills">4</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white bg-danger">
                                <div class="card-body">
                                    <h5 class="card-title">Total Revenue</h5>
                                    <h2 id="totalRevenue">RM 12,450</h2>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    Recent Cashbills
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Customer</th>
                                                    <th>Date</th>
                                                    <th>Amount</th>
                                                    <th>Status</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>#PA0001</td>
                                                    <td>Ali Ahmad</td>
                                                    <td>2023-06-15</td>
                                                    <td>RM 250.00</td>
                                                    <td><span class="status-badge status-committed">Committed</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-primary view-cashbill" data-id="#PA0001">View</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>#PA0002</td>
                                                    <td>Siti Aminah</td>
                                                    <td>2023-06-16</td>
                                                    <td>RM 170.00</td>
                                                    <td><span class="status-badge status-pending">Pending Approval</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-primary view-cashbill" data-id="#PA0002">View</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>#PA0003</td>
                                                    <td>Abu Bakar</td>
                                                    <td>2023-06-17</td>
                                                    <td>RM 450.00</td>
                                                    <td><span class="status-badge status-approved">Approved</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-primary view-cashbill" data-id="#PA0003">View</button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    Quick Actions
                                </div>
                                <div class="card-body">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary" id="newCashbillBtn">
                                            <i class="fas fa-plus-circle me-2"></i> New Cashbill
                                        </button>
                                        <button class="btn btn-outline-primary" id="newLogbookBtn">
                                            <i class="fas fa-plus-circle me-2"></i> New Logbook Entry
                                        </button>
                                        <button class="btn btn-outline-secondary">
                                            <i class="fas fa-file-export me-2"></i> Export Data
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Cashbill Section -->
            <div id="cashbill" class="content-section">
                <div class="container-fluid">
                    <h2 class="mb-4">Cashbill Management</h2>
                    
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <span>Create New Cashbill</span>
                                    <button class="btn btn-sm btn-light" id="viewCashbillListBtn">
                                        <i class="fas fa-list me-1"></i> View All
                                    </button>
                                </div>
                                <div class="card-body">
                                    <form id="cashbillForm">
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="cashbillId" class="form-label">Cashbill ID</label>
                                                <input type="text" class="form-control" id="cashbillId" value="#PA0004" readonly>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="cashbillDate" class="form-label">Date</label>
                                                <input type="date" class="form-control" id="cashbillDate" required>
                                            </div>
                                        </div>
                                        
                                        <h5 class="mt-4 mb-3">Customer Information</h5>
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="customerFirstName" class="form-label">First Name</label>
                                                <input type="text" class="form-control" id="customerFirstName" required>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="customerLastName" class="form-label">Last Name</label>
                                                <input type="text" class="form-control" id="customerLastName" required>
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="customerPhone" class="form-label">Phone Number</label>
                                                <input type="tel" class="form-control" id="customerPhone" required>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="customerEmail" class="form-label">Email</label>
                                                <input type="email" class="form-control" id="customerEmail">
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="customerAddress" class="form-label">Address</label>
                                            <textarea class="form-control" id="customerAddress" rows="2" required></textarea>
                                        </div>
                                        
                                        <h5 class="mt-4 mb-3">Order Items</h5>
                                        <div class="mb-3">
                                            <div class="row">
                                                <div class="col-md-5">
                                                    <label for="productSelect" class="form-label">Select Product</label>
                                                    <select class="form-select" id="productSelect">
                                                        <option value="">-- Select Product --</option>
                                                        <option value="adult-jubah">üïå Adult Jubah - RM 250</option>
                                                        <option value="year6-jubah">üìò Year 6 Jubah - RM 170</option>
                                                        <option value="kindergarten-jubah">üßí Kindergarten Jubah - RM 110</option>
                                                        <option value="plaque">üè∑Ô∏è Plaque Arkalic - RM 19.90</option>
                                                        <option value="medal">üèÖ Cute Medal - RM 12.90</option>
                                                        <option value="keychain">üîë Cute Keychain - RM 5.90</option>
                                                        <option value="attendance-keychain">üîë Attendance Keychain - RM 4.90</option>
                                                        <option value="kindergarten-tshirt">üëï Kindergarten T-Shirt - RM 29.90</option>
                                                        <option value="kindergarten-set">üëïüëñ Kindergarten T-Shirt + Pants Set - RM 45.00</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-3">
                                                    <label for="quantity" class="form-label">Quantity</label>
                                                    <input type="number" class="form-control" id="quantity" min="1" value="1">
                                                </div>
                                                <div class="col-md-3">
                                                    <label for="price" class="form-label">Price (RM)</label>
                                                    <input type="number" class="form-control" id="price" step="0.01" min="0">
                                                </div>
                                                <div class="col-md-1 d-flex align-items-end">
                                                    <button type="button" class="btn btn-primary" id="addItemBtn">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <div class="card">
                                                <div class="card-header">
                                                    Order Items
                                                </div>
                                                <div class="card-body">
                                                    <div id="orderItems">
                                                        <div class="cashbill-item">
                                                            <div>
                                                                <div class="fw-bold">Adult Jubah</div>
                                                                <div>1 x RM 250.00</div>
                                                            </div>
                                                            <div class="item-actions">
                                                                <button type="button" class="btn btn-sm btn-outline-danger remove-item">
                                                                    <i class="fas fa-trash"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mt-3 text-end">
                                                        <h5>Total: RM <span id="totalAmount">250.00</span></h5>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <h5 class="mt-4 mb-3">Payment Information</h5>
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="paymentType" class="form-label">Payment Type</label>
                                                <select class="form-select" id="paymentType" required>
                                                    <option value="">-- Select Payment Type --</option>
                                                    <option value="cash">Cash</option>
                                                    <option value="bank-transfer">Bank Transfer</option>
                                                    <option value="credit-card">Credit Card</option>
                                                    <option value="e-wallet">E-Wallet</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="paymentStatus" class="form-label">Payment Status</label>
                                                <select class="form-select" id="paymentStatus" required>
                                                    <option value="pending">Pending</option>
                                                    <option value="partial">Partial</option>
                                                    <option value="completed">Completed</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-12">
                                                <label for="notes" class="form-label">Notes</label>
                                                <textarea class="form-control" id="notes" rows="2"></textarea>
                                            </div>
                                        </div>
                                        
                                        <div class="d-flex justify-content-between mt-4">
                                            <button type="button" class="btn btn-secondary" id="resetCashbillBtn">Reset</button>
                                            <div>
                                                <button type="button" class="btn btn-warning me-2" id="saveDraftBtn">Save as Draft</button>
                                                <button type="submit" class="btn btn-primary" id="commitCashbillBtn">Commit Cashbill</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Logbook Section -->
            <div id="logbook" class="content-section">
                <div class="container-fluid">
                    <h2 class="mb-4">Courier Logbook</h2>
                    
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <span>Create New Logbook Entry</span>
                                    <button class="btn btn-sm btn-light" id="viewLogbookListBtn">
                                        <i class="fas fa-list me-1"></i> View All
                                    </button>
                                </div>
                                <div class="card-body">
                                    <form id="logbookForm">
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="logbookId" class="form-label">Logbook ID</label>
                                                <input type="text" class="form-control" id="logbookId" value="LOG-0001" readonly>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="logbookDate" class="form-label">Date</label>
                                                <input type="date" class="form-control" id="logbookDate" required>
                                            </div>
                                        </div>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="cashbillRef" class="form-label">Cashbill Reference</label>
                                                <select class="form-select" id="cashbillRef" required>
                                                    <option value="">-- Select Cashbill --</option>
                                                    <option value="#PA0001">#PA0001 - Ali Ahmad</option>
                                                    <option value="#PA0002">#PA0002 - Siti Aminah</option>
                                                    <option value="#PA0003">#PA0003 - Abu Bakar</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="trackingNumber" class="form-label">Tracking Number</label>
                                                <input type="text" class="form-control" id="trackingNumber">
                                            </div>
                                        </div>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="courierName" class="form-label">Courier Name</label>
                                                <input type="text" class="form-control" id="courierName" required>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="deliveryStatus" class="form-label">Delivery Status</label>
                                                <select class="form-select" id="deliveryStatus" required>
                                                    <option value="preparing">Preparing</option>
                                                    <option value="picked-up">Picked Up</option>
                                                    <option value="in-transit">In Transit</option>
                                                    <option value="delivered">Delivered</option>
                                                    <option value="returned">Returned</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="deliveryAddress" class="form-label">Delivery Address</label>
                                            <textarea class="form-control" id="deliveryAddress" rows="2" required></textarea>
                                        </div>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="deliveryDate" class="form-label">Expected Delivery Date</label>
                                                <input type="date" class="form-control" id="deliveryDate">
                                            </div>
                                            <div class="col-md-6">
                                                <label for="deliveryTime" class="form-label">Expected Delivery Time</label>
                                                <input type="time" class="form-control" id="deliveryTime">
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="logbookNotes" class="form-label">Notes</label>
                                            <textarea class="form-control" id="logbookNotes" rows="2"></textarea>
                                        </div>
                                        
                                        <div class="d-flex justify-content-between mt-4">
                                            <button type="button" class="btn btn-secondary" id="resetLogbookBtn">Reset</button>
                                            <div>
                                                <button type="button" class="btn btn-warning me-2" id="saveLogbookDraftBtn">Save as Draft</button>
                                                <button type="submit" class="btn btn-primary" id="saveLogbookBtn">Save Logbook</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Uncommitted Requests Section (Admin Only) -->
            <div id="uncommitted" class="content-section">
                <div class="container-fluid">
                    <h2 class="mb-4">Uncommitted Requests</h2>
                    
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header">
                                    Pending Approval
                                </div>
                                <div class="card-body">
                                    <div id="uncommittedList">
                                        <div class="card uncommitted-card mb-3">
                                            <div class="card-header d-flex justify-content-between align-items-center">
                                                <span>#PA0005 - Ahmad Ibrahim</span>
                                                <span class="status-badge status-draft">Draft</span>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <p><strong>Date:</strong> 2023-06-18</p>
                                                        <p><strong>Created by:</strong> Staff 0001</p>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <p><strong>Total Amount:</strong> RM 370.00</p>
                                                        <p><strong>Items:</strong> Adult Jubah (1x), Year 6 Jubah (1x)</p>
                                                    </div>
                                                </div>
                                                <div class="action-buttons mt-3">
                                                    <button class="btn btn-sm btn-primary view-uncommitted" data-id="#PA0005">View Details</button>
                                                    <button class="btn btn-sm btn-success approve-uncommitted" data-id="#PA0005">Approve</button>
                                                    <button class="btn btn-sm btn-danger reject-uncommitted" data-id="#PA0005">Reject</button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="card uncommitted-card mb-3">
                                            <div class="card-header d-flex justify-content-between align-items-center">
                                                <span>#PA0006 - Siti Khadijah</span>
                                                <span class="status-badge status-draft">Draft</span>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <p><strong>Date:</strong> 2023-06-18</p>
                                                        <p><strong>Created by:</strong> Staff 0001</p>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <p><strong>Total Amount:</strong> RM 85.70</p>
                                                        <p><strong>Items:</strong> Plaque Arkalic (2x), Cute Keychain (3x)</p>
                                                    </div>
                                                </div>
                                                <div class="action-buttons mt-3">
                                                    <button class="btn btn-sm btn-primary view-uncommitted" data-id="#PA0006">View Details</button>
                                                    <button class="btn btn-sm btn-success approve-uncommitted" data-id="#PA0006">Approve</button>
                                                    <button class="btn btn-sm btn-danger reject-uncommitted" data-id="#PA0006">Reject</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Products Section -->
            <div id="products" class="content-section">
                <div class="container-fluid">
                    <h2 class="mb-4">Product Management</h2>
                    
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <span>Product Catalog</span>
                                    <button class="btn btn-sm btn-primary admin-only" id="addProductBtn">
                                        <i class="fas fa-plus me-1"></i> Add Product
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üïå Adult Jubah</div>
                                                <div class="price-tag">Price: RM 250 per set</div>
                                                <div class="member-price">Member Price: RM 220 per set</div>
                                                <div>Free: Cap included</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üìò Year 6 Jubah</div>
                                                <div class="price-tag">Price: RM 170 per set</div>
                                                <div class="member-price">Member Price: RM 150 per set</div>
                                                <div>Free: Cap included</div>
                                                <div class="min-order">Minimum Order: 10 sets</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üßí Kindergarten Jubah</div>
                                                <div class="price-tag">Price: RM 110 per set</div>
                                                <div class="member-price">Member Price: RM 99 per set</div>
                                                <div>Free: Cap included</div>
                                                <div class="min-order">Minimum Order: 10 sets</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üè∑Ô∏è Plaque Arkalic</div>
                                                <div class="price-tag">Price: RM 19.90</div>
                                                <div class="member-price">Member Price: RM 17.50</div>
                                                <div>Includes: Name printing</div>
                                                <div>Size: 145mm x 100mm</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üèÖ Cute Medal</div>
                                                <div class="price-tag">Price: RM 12.90</div>
                                                <div class="member-price">Member Price: RM 10.90</div>
                                                <div>Material: Arkalic</div>
                                                <div class="min-order">Minimum Order: 10 pcs</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üîë Cute Keychain</div>
                                                <div class="price-tag">Price: RM 5.90 each</div>
                                                <div class="member-price">Member Price: RM 3.90 each</div>
                                                <div>Material: Arkalic (Sublimation)</div>
                                                <div>Size: 9cm x 3cm</div>
                                                <div class="min-order">Minimum Order: 10 pcs</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üîë Attendance Keychain</div>
                                                <div class="price-tag">Price: RM 4.90 each</div>
                                                <div class="member-price">Member Price: RM 3.50 each</div>
                                                <div>Material: Acrylic</div>
                                                <div>Thickness: 2mm</div>
                                                <div>Size: 4.4cm x 5.5cm</div>
                                                <div class="min-order">Minimum Order: 10 pcs</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üëï Kindergarten T-Shirt</div>
                                                <div class="price-tag">Price: RM 29.90 per piece</div>
                                                <div class="member-price">Member Price: RM 25.00 per piece</div>
                                                <div>Material: Microfiber</div>
                                                <div>Free: School name & logo printing</div>
                                                <div class="min-order">Minimum Order: 20 pieces</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <div class="product-item">
                                                <div class="product-name">üëïüëñ Kindergarten T-Shirt + Pants Set</div>
                                                <div class="price-tag">Price: RM 45.00 per set</div>
                                                <div class="member-price">Member Price: RM 39.90 per set</div>
                                                <div>Material: Microfiber + Tracksuit</div>
                                                <div class="min-order">Minimum Order: 20 sets</div>
                                                <div class="mt-2">
                                                    <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-product">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger admin-only delete-product">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Staff Management Section -->
            <div id="staff" class="content-section">
                <div class="container-fluid">
                    <h2 class="mb-4">Staff Management</h2>
                    
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <span>Staff List</span>
                                    <button class="btn btn-sm btn-primary admin-only" id="addStaffBtn">
                                        <i class="fas fa-user-plus me-1"></i> Add New Staff
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Staff ID</th>
                                                    <th>Name</th>
                                                    <th>Username</th>
                                                    <th>Role</th>
                                                    <th>Status</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>0000</td>
                                                    <td>Admin User</td>
                                                    <td>0000</td>
                                                    <td><span class="user-role role-admin">Admin</span></td>
                                                    <td><span class="badge bg-success">Active</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-staff">Edit</button>
                                                        <button class="btn btn-sm btn-outline-danger admin-only delete-staff">Delete</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>0001</td>
                                                    <td>Crew One</td>
                                                    <td>0001</td>
                                                    <td><span class="user-role role-staff">Crew</span></td>
                                                    <td><span class="badge bg-success">Active</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-staff">Edit</button>
                                                        <button class="btn btn-sm btn-outline-danger admin-only delete-staff">Delete</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>0002</td>
                                                    <td>Crew Two</td>
                                                    <td>0002</td>
                                                    <td><span class="user-role role-staff">Crew</span></td>
                                                    <td><span class="badge bg-success">Active</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-outline-primary me-1 admin-only edit-staff">Edit</button>
                                                        <button class="btn btn-sm btn-outline-danger admin-only delete-staff">Delete</button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Reports Section -->
            <div id="reports" class="content-section">
                <div class="container-fluid">
                    <h2 class="mb-4">Reports</h2>
                    
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header">
                                    Generate Reports
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6 mb-4">
                                            <div class="card h-100">
                                                <div class="card-body text-center">
                                                    <i class="fas fa-file-invoice-dollar fa-3x text-primary mb-3"></i>
                                                    <h5>Cashbill Report</h5>
                                                    <p class="text-muted">Generate cashbill reports with filters</p>
                                                    <button class="btn btn-primary generate-report" data-type="cashbill">Generate</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-4">
                                            <div class="card h-100">
                                                <div class="card-body text-center">
                                                    <i class="fas fa-truck fa-3x text-success mb-3"></i>
                                                    <h5>Delivery Report</h5>
                                                    <p class="text-muted">Generate delivery and logistics reports</p>
                                                    <button class="btn btn-primary generate-report" data-type="delivery">Generate</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-4">
                                            <div class="card h-100">
                                                <div class="card-body text-center">
                                                    <i class="fas fa-chart-line fa-3x text-warning mb-3"></i>
                                                    <h5>Sales Report</h5>
                                                    <p class="text-muted">Generate sales and revenue reports</p>
                                                    <button class="btn btn-primary generate-report" data-type="sales">Generate</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-4">
                                            <div class="card h-100">
                                                <div class="card-body text-center">
                                                    <i class="fas fa-box fa-3x text-info mb-3"></i>
                                                    <h5>Inventory Report</h5>
                                                    <p class="text-muted">Generate inventory and stock reports</p>
                                                    <button class="btn btn-primary generate-report" data-type="inventory">Generate</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Toast Container -->
    <div class="toast-container"></div>
    <!-- Add Product Modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addProductModalLabel">Add New Product</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addProductForm">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="productName" class="form-label">Product Name</label>
                                <input type="text" class="form-control" id="productName" required>
                            </div>
                            <div class="col-md-6">
                                <label for="productIcon" class="form-label">Product Icon</label>
                                <select class="form-select" id="productIcon">
                                    <option value="">-- Select Icon --</option>
                                    <option value="üïå">üïå Mosque</option>
                                    <option value="üìò">üìò Book</option>
                                    <option value="üßí">üßí Child</option>
                                    <option value="üè∑Ô∏è">üè∑Ô∏è Label</option>
                                    <option value="üèÖ">üèÖ Medal</option>
                                    <option value="üîë">üîë Key</option>
                                    <option value="üëï">üëï T-Shirt</option>
                                    <option value="üëñ">üëñ Pants</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="regularPrice" class="form-label">Regular Price (RM)</label>
                                <input type="number" class="form-control" id="regularPrice" step="0.01" min="0" required>
                            </div>
                            <div class="col-md-6">
                                <label for="memberPrice" class="form-label">Member Price (RM)</label>
                                <input type="number" class="form-control" id="memberPrice" step="0.01" min="0" required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="productUnit" class="form-label">Unit</label>
                                <select class="form-select" id="productUnit">
                                    <option value="per set">Per Set</option>
                                    <option value="per piece">Per Piece</option>
                                    <option value="each">Each</option>
                                    <option value="per pc">Per PC</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="minOrder" class="form-label">Minimum Order</label>
                                <input type="number" class="form-control" id="minOrder" min="0" value="0">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="productDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="productDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="productFeatures" class="form-label">Features (one per line)</label>
                            <textarea class="form-control" id="productFeatures" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveProductBtn">Save Product</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Add Staff Modal -->
    <div class="modal fade" id="addStaffModal" tabindex="-1" aria-labelledby="addStaffModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addStaffModalLabel">Add New Staff</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addStaffForm">
                        <div class="mb-3">
                            <label for="staffFirstName" class="form-label">First Name</label>
                            <input type="text" class="form-control" id="staffFirstName" required>
                        </div>
                        <div class="mb-3">
                            <label for="staffLastName" class="form-label">Last Name</label>
                            <input type="text" class="form-control" id="staffLastName" required>
                        </div>
                        <div class="mb-3">
                            <label for="staffUsername" class="form-label">Staff ID</label>
                            <input type="text" class="form-control" id="staffUsername" required>
                        </div>
                        <div class="mb-3">
                            <label for="staffPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="staffPassword" required>
                        </div>
                        <div class="mb-3">
                            <label for="staffRole" class="form-label">Role</label>
                            <select class="form-select" id="staffRole" required>
                                <option value="staff">Crew</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveStaffBtn">Save Staff</button>
                </div>
            </div>
        </div>
    </div>
    <!-- View Cashbill Modal -->
    <div class="modal fade" id="viewCashbillModal" tabindex="-1" aria-labelledby="viewCashbillModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewCashbillModalLabel">Cashbill Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="cashbillDetails">
                        <!-- Cashbill details will be populated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="printCashbillBtn">Print</button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('cashbillDate').value = today;
            document.getElementById('logbookDate').value = today;
            
            // Initialize variables
            let currentUser = null;
            let sidebarOpen = false;
            let currentSection = 'dashboard';
            let cashbillCounter = 4; // Starting from #PA0004
            let logbookCounter = 1; // Starting from LOG-0001
            let uncommittedCashbills = [
                {
                    id: '#PA0005',
                    customer: 'Ahmad Ibrahim',
                    date: '2023-06-18',
                    createdBy: 'Staff 0001',
                    totalAmount: 370.00,
                    items: [
                        { name: 'Adult Jubah', quantity: 1, price: 250.00 },
                        { name: 'Year 6 Jubah', quantity: 1, price: 170.00 }
                    ],
                    status: 'draft'
                },
                {
                    id: '#PA0006',
                    customer: 'Siti Khadijah',
                    date: '2023-06-18',
                    createdBy: 'Staff 0001',
                    totalAmount: 85.70,
                    items: [
                        { name: 'Plaque Arkalic', quantity: 2, price: 19.90 },
                        { name: 'Cute Keychain', quantity: 3, price: 5.90 }
                    ],
                    status: 'draft'
                }
            ];
            
            // DOM elements
            const loginPage = document.getElementById('loginPage');
            const portalContainer = document.getElementById('portalContainer');
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const overlay = document.getElementById('overlay');
            const menuToggle = document.getElementById('menuToggle');
            const loginForm = document.getElementById('loginForm');
            const logoutBtn = document.getElementById('logoutBtn');
            const logoutBtn2 = document.getElementById('logoutBtn2');
            const menuLinks = document.querySelectorAll('.menu-link');
            const contentSections = document.querySelectorAll('.content-section');
            const userName = document.getElementById('userName');
            const userRole = document.getElementById('userRole');
            
            // Login form submission
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                // Simple authentication (in a real app, this would be server-side)
                if (username === '0000' && password === 'Dd123') {
                    currentUser = {
                        username: '0000',
                        name: 'Admin User',
                        role: 'admin'
                    };
                    showPortal();
                } else if (username === '0001' && password === '1234') {
                    currentUser = {
                        username: '0001',
                        name: 'Crew One',
                        role: 'staff'
                    };
                    showPortal();
                } else {
                    showToast('Invalid Staff ID or password', 'danger');
                }
            });
            
            // Show portal after login
            function showPortal() {
                loginPage.style.display = 'none';
                portalContainer.style.display = 'block';
                
                // Set user info
                userName.textContent = currentUser.name;
                userRole.textContent = currentUser.role === 'admin' ? 'Admin' : 'Crew';
                userRole.className = `user-role ${currentUser.role === 'admin' ? 'role-admin' : 'role-staff'}`;
                
                // Show success message
                showToast(`Welcome, ${currentUser.name}!`, 'success');
                
                // Check if user is admin to show/hide certain features
                if (currentUser.role === 'staff') {
                    // Hide admin-only features for regular staff
                    document.querySelectorAll('.admin-only').forEach(el => {
                        el.style.display = 'none';
                    });
                }
            }
            
            // Logout functionality
            logoutBtn.addEventListener('click', logout);
            logoutBtn2.addEventListener('click', logout);
            
            function logout() {
                currentUser = null;
                loginPage.style.display = 'block';
                portalContainer.style.display = 'none';
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                showToast('You have been logged out', 'info');
            }
            
            // Toggle sidebar
            menuToggle.addEventListener('click', toggleSidebar);
            overlay.addEventListener('click', closeSidebar);
            
            function toggleSidebar() {
                sidebarOpen = !sidebarOpen;
                
                if (sidebarOpen) {
                    sidebar.classList.add('active');
                    mainContent.classList.add('shifted');
                    overlay.classList.add('active');
                } else {
                    closeSidebar();
                }
            }
            
            function closeSidebar() {
                sidebarOpen = false;
                sidebar.classList.remove('active');
                mainContent.classList.remove('shifted');
                overlay.classList.remove('active');
            }
            
            // Menu navigation
            menuLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const section = this.getAttribute('data-section');
                    if (section) {
                        showSection(section);
                        closeSidebar();
                    }
                });
            });
            
            function showSection(sectionName) {
                // Update active menu link
                menuLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('data-section') === sectionName) {
                        link.classList.add('active');
                    }
                });
                
                // Show selected section
                contentSections.forEach(section => {
                    section.classList.remove('active');
                    if (section.id === sectionName) {
                        section.classList.add('active');
                    }
                });
                
                currentSection = sectionName;
                
                // Refresh uncommitted list if navigating to that section
                if (sectionName === 'uncommitted') {
                    refreshUncommittedList();
                }
            }
            
            // Quick action buttons
            document.getElementById('newCashbillBtn').addEventListener('click', function() {
                showSection('cashbill');
                // Generate new cashbill ID
                cashbillCounter++;
                document.getElementById('cashbillId').value = `#PA${String(cashbillCounter).padStart(4, '0')}`;
            });
            
            document.getElementById('newLogbookBtn').addEventListener('click', function() {
                showSection('logbook');
                // Generate new logbook ID
                logbookCounter++;
                document.getElementById('logbookId').value = `LOG-${String(logbookCounter).padStart(4, '0')}`;
            });
            
            // Cashbill form handling
            const cashbillForm = document.getElementById('cashbillForm');
            const addItemBtn = document.getElementById('addItemBtn');
            const productSelect = document.getElementById('productSelect');
            const quantityInput = document.getElementById('quantity');
            const priceInput = document.getElementById('price');
            const orderItemsContainer = document.getElementById('orderItems');
            const totalAmountSpan = document.getElementById('totalAmount');
            
            // Set price when product is selected
            productSelect.addEventListener('change', function() {
                const productPrices = {
                    'adult-jubah': 250,
                    'year6-jubah': 170,
                    'kindergarten-jubah': 110,
                    'plaque': 19.90,
                    'medal': 12.90,
                    'keychain': 5.90,
                    'attendance-keychain': 4.90,
                    'kindergarten-tshirt': 29.90,
                    'kindergarten-set': 45.00
                };
                
                if (this.value && productPrices[this.value]) {
                    priceInput.value = productPrices[this.value];
                    
                    // Disable price editing for staff users
                    if (currentUser && currentUser.role === 'staff') {
                        priceInput.disabled = true;
                    } else {
                        priceInput.disabled = false;
                    }
                } else {
                    priceInput.value = '';
                }
            });
            
            // Add item to order
            addItemBtn.addEventListener('click', function() {
                const productId = productSelect.value;
                const quantity = parseInt(quantityInput.value) || 1;
                const price = parseFloat(priceInput.value) || 0;
                
                if (!productId) {
                    showToast('Please select a product', 'warning');
                    return;
                }
                
                const productText = productSelect.options[productSelect.selectedIndex].text;
                const productName = productText.split(' - ')[0];
                
                // Create new item element
                const itemElement = document.createElement('div');
                itemElement.className = 'cashbill-item';
                itemElement.innerHTML = `
                    <div>
                        <div class="fw-bold">${productName}</div>
                        <div>${quantity} x RM ${price.toFixed(2)}</div>
                    </div>
                    <div class="item-actions">
                        <button type="button" class="btn btn-sm btn-outline-danger remove-item">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                // Add remove functionality
                itemElement.querySelector('.remove-item').addEventListener('click', function() {
                    itemElement.remove();
                    updateTotalAmount();
                });
                
                // Add to order items
                orderItemsContainer.appendChild(itemElement);
                
                // Update total
                updateTotalAmount();
                
                // Reset form
                productSelect.value = '';
                quantityInput.value = '1';
                priceInput.value = '';
            });
            
            // Update total amount
            function updateTotalAmount() {
                let total = 0;
                
                orderItemsContainer.querySelectorAll('.cashbill-item').forEach(item => {
                    const text = item.querySelector('div div:last-child').textContent;
                    const match = text.match(/(\d+) x RM ([\d.]+)/);
                    
                    if (match) {
                        const quantity = parseInt(match[1]);
                        const price = parseFloat(match[2]);
                        total += quantity * price;
                    }
                });
                
                totalAmountSpan.textContent = total.toFixed(2);
            }
            
            // Cashbill form submission
            cashbillForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Check if there are items in the order
                if (orderItemsContainer.children.length === 0) {
                    showToast('Please add at least one item to the order', 'warning');
                    return;
                }
                
                // In a real app, this would send data to the server
                const cashbillId = document.getElementById('cashbillId').value;
                showToast(`Cashbill ${cashbillId} committed successfully!`, 'success');
                
                // Reset form after a delay
                setTimeout(() => {
                    cashbillForm.reset();
                    orderItemsContainer.innerHTML = '';
                    totalAmountSpan.textContent = '0.00';
                    document.getElementById('cashbillDate').value = today;
                    
                    // Generate new cashbill ID
                    cashbillCounter++;
                    document.getElementById('cashbillId').value = `#PA${String(cashbillCounter).padStart(4, '0')}`;
                }, 1500);
            });
            
            // Reset cashbill form
            document.getElementById('resetCashbillBtn').addEventListener('click', function() {
                if (confirm('Are you sure you want to reset the form? All data will be lost.')) {
                    cashbillForm.reset();
                    orderItemsContainer.innerHTML = '';
                    totalAmountSpan.textContent = '0.00';
                    document.getElementById('cashbillDate').value = today;
                    
                    // Generate new cashbill ID
                    cashbillCounter++;
                    document.getElementById('cashbillId').value = `#PA${String(cashbillCounter).padStart(4, '0')}`;
                }
            });
            
            // Save draft button
            document.getElementById('saveDraftBtn').addEventListener('click', function() {
                // Check if there are items in the order
                if (orderItemsContainer.children.length === 0) {
                    showToast('Please add at least one item to the order', 'warning');
                    return;
                }
                
                // Get form data
                const cashbillId = document.getElementById('cashbillId').value;
                const customerFirstName = document.getElementById('customerFirstName').value;
                const customerLastName = document.getElementById('customerLastName').value;
                const customerName = `${customerFirstName} ${customerLastName}`;
                const cashbillDate = document.getElementById('cashbillDate').value;
                
                // Get order items
                const items = [];
                orderItemsContainer.querySelectorAll('.cashbill-item').forEach(item => {
                    const name = item.querySelector('.fw-bold').textContent;
                    const text = item.querySelector('div div:last-child').textContent;
                    const match = text.match(/(\d+) x RM ([\d.]+)/);
                    
                    if (match) {
                        const quantity = parseInt(match[1]);
                        const price = parseFloat(match[2]);
                        items.push({ name, quantity, price });
                    }
                });
                
                // Calculate total
                const totalAmount = parseFloat(totalAmountSpan.textContent);
                
                // Create uncommitted cashbill object
                const uncommittedCashbill = {
                    id: cashbillId,
                    customer: customerName,
                    date: cashbillDate,
                    createdBy: `Staff ${currentUser.username}`,
                    totalAmount: totalAmount,
                    items: items,
                    status: 'draft'
                };
                
                // Add to uncommitted list
                uncommittedCashbills.push(uncommittedCashbill);
                
                showToast(`Cashbill ${cashbillId} saved as draft!`, 'info');
                
                // Reset form after a delay
                setTimeout(() => {
                    cashbillForm.reset();
                    orderItemsContainer.innerHTML = '';
                    totalAmountSpan.textContent = '0.00';
                    document.getElementById('cashbillDate').value = today;
                    
                    // Generate new cashbill ID
                    cashbillCounter++;
                    document.getElementById('cashbillId').value = `#PA${String(cashbillCounter).padStart(4, '0')}`;
                }, 1500);
            });
            
            // Logbook form handling
            const logbookForm = document.getElementById('logbookForm');
            
            logbookForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // In a real app, this would send data to the server
                const logbookId = document.getElementById('logbookId').value;
                showToast(`Logbook ${logbookId} saved successfully!`, 'success');
                
                // Reset form after a delay
                setTimeout(() => {
                    logbookForm.reset();
                    document.getElementById('logbookDate').value = today;
                    
                    // Generate new logbook ID
                    logbookCounter++;
                    document.getElementById('logbookId').value = `LOG-${String(logbookCounter).padStart(4, '0')}`;
                }, 1500);
            });
            
            // Reset logbook form
            document.getElementById('resetLogbookBtn').addEventListener('click', function() {
                if (confirm('Are you sure you want to reset the form? All data will be lost.')) {
                    logbookForm.reset();
                    document.getElementById('logbookDate').value = today;
                    
                    // Generate new logbook ID
                    logbookCounter++;
                    document.getElementById('logbookId').value = `LOG-${String(logbookCounter).padStart(4, '0')}`;
                }
            });
            
            // Save logbook draft
            document.getElementById('saveLogbookDraftBtn').addEventListener('click', function() {
                const logbookId = document.getElementById('logbookId').value;
                showToast(`Logbook ${logbookId} saved as draft!`, 'info');
            });
            
            // Product management
            const addProductBtn = document.getElementById('addProductBtn');
            const addProductModal = new bootstrap.Modal(document.getElementById('addProductModal'));
            const saveProductBtn = document.getElementById('saveProductBtn');
            
            addProductBtn.addEventListener('click', function() {
                // Only allow admin to add products
                if (currentUser && currentUser.role === 'admin') {
                    addProductModal.show();
                } else {
                    showToast('You do not have permission to add products', 'danger');
                }
            });
            
            saveProductBtn.addEventListener('click', function() {
                // Get form data
                const productName = document.getElementById('productName').value;
                
                // In a real app, this would send data to the server
                showToast(`Product "${productName}" added successfully!`, 'success');
                addProductModal.hide();
                document.getElementById('addProductForm').reset();
            });
            
            // Edit product buttons
            document.querySelectorAll('.edit-product').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (currentUser && currentUser.role === 'admin') {
                        showToast('Edit product functionality would open here', 'info');
                    } else {
                        showToast('You do not have permission to edit products', 'danger');
                    }
                });
            });
            
            // Delete product buttons
            document.querySelectorAll('.delete-product').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (currentUser && currentUser.role === 'admin') {
                        if (confirm('Are you sure you want to delete this product?')) {
                            showToast('Product deleted successfully', 'success');
                            // In a real app, this would remove the product from the database
                        }
                    } else {
                        showToast('You do not have permission to delete products', 'danger');
                    }
                });
            });
            
            // Staff management
            const addStaffBtn = document.getElementById('addStaffBtn');
            const addStaffModal = new bootstrap.Modal(document.getElementById('addStaffModal'));
            const saveStaffBtn = document.getElementById('saveStaffBtn');
            
            addStaffBtn.addEventListener('click', function() {
                // Only allow admin to add staff
                if (currentUser && currentUser.role === 'admin') {
                    addStaffModal.show();
                } else {
                    showToast('You do not have permission to add staff', 'danger');
                }
            });
            
            saveStaffBtn.addEventListener('click', function() {
                // Get form data
                const staffFirstName = document.getElementById('staffFirstName').value;
                const staffLastName = document.getElementById('staffLastName').value;
                const staffName = `${staffFirstName} ${staffLastName}`;
                
                // In a real app, this would send data to the server
                showToast(`Staff "${staffName}" added successfully!`, 'success');
                addStaffModal.hide();
                document.getElementById('addStaffForm').reset();
            });
            
            // Edit staff buttons
            document.querySelectorAll('.edit-staff').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (currentUser && currentUser.role === 'admin') {
                        showToast('Edit staff functionality would open here', 'info');
                    } else {
                        showToast('You do not have permission to edit staff', 'danger');
                    }
                });
            });
            
            // Delete staff buttons
            document.querySelectorAll('.delete-staff').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (currentUser && currentUser.role === 'admin') {
                        if (confirm('Are you sure you want to delete this staff member?')) {
                            showToast('Staff member deleted successfully', 'success');
                            // In a real app, this would remove the staff from the database
                        }
                    } else {
                        showToast('You do not have permission to delete staff', 'danger');
                    }
                });
            });
            
            // View cashbill buttons
            document.querySelectorAll('.view-cashbill').forEach(btn => {
                btn.addEventListener('click', function() {
                    const cashbillId = this.getAttribute('data-id');
                    viewCashbillDetails(cashbillId);
                });
            });
            
            // View cashbill details function
            function viewCashbillDetails(cashbillId) {
                // In a real app, this would fetch data from the server
                // For demo purposes, we'll use mock data
                
                let cashbillData;
                
                // Check if it's one of our mock uncommitted cashbills
                const uncommitted = uncommittedCashbills.find(cb => cb.id === cashbillId);
                if (uncommitted) {
                    cashbillData = uncommitted;
                } else {
                    // Use mock data for committed cashbills
                    cashbillData = {
                        id: cashbillId,
                        customer: 'Mock Customer',
                        date: '2023-06-15',
                        createdBy: 'Staff 0001',
                        totalAmount: 250.00,
                        items: [
                            { name: 'Adult Jubah', quantity: 1, price: 250.00 }
                        ],
                        status: 'committed'
                    };
                }
                
                // Populate modal with cashbill details
                const cashbillDetails = document.getElementById('cashbillDetails');
                cashbillDetails.innerHTML = `
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <p><strong>Cashbill ID:</strong> ${cashbillData.id}</p>
                            <p><strong>Customer:</strong> ${cashbillData.customer}</p>
                            <p><strong>Date:</strong> ${cashbillData.date}</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Status:</strong> <span class="status-badge status-${cashbillData.status}">${cashbillData.status.charAt(0).toUpperCase() + cashbillData.status.slice(1)}</span></p>
                            <p><strong>Created By:</strong> ${cashbillData.createdBy}</p>
                            <p><strong>Total Amount:</strong> RM ${cashbillData.totalAmount.toFixed(2)}</p>
                        </div>
                    </div>
                    
                    <h5 class="mt-4 mb-3">Order Items</h5>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th>Quantity</th>
                                    <th>Price</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${cashbillData.items.map(item => `
                                    <tr>
                                        <td>${item.name}</td>
                                        <td>${item.quantity}</td>
                                        <td>RM ${item.price.toFixed(2)}</td>
                                        <td>RM ${(item.quantity * item.price).toFixed(2)}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="3" class="text-end"><strong>Total:</strong></td>
                                    <td><strong>RM ${cashbillData.totalAmount.toFixed(2)}</strong></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                `;
                
                // Show modal
                const viewCashbillModal = new bootstrap.Modal(document.getElementById('viewCashbillModal'));
                viewCashbillModal.show();
            }
            
            // Print cashbill button
            document.getElementById('printCashbillBtn').addEventListener('click', function() {
                showToast('Print functionality would be implemented here', 'info');
                // In a real app, this would open a print dialog or generate a PDF
            });
            
            // Uncommitted requests functionality
            function refreshUncommittedList() {
                const uncommittedList = document.getElementById('uncommittedList');
                
                // Clear existing list
                uncommittedList.innerHTML = '';
                
                // Add each uncommitted cashbill to the list
                uncommittedCashbills.forEach(cashbill => {
                    const itemsText = cashbill.items.map(item => 
                        `${item.name} (${item.quantity}x)`
                    ).join(', ');
                    
                    const cardElement = document.createElement('div');
                    cardElement.className = 'card uncommitted-card mb-3';
                    cardElement.innerHTML = `
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span>${cashbill.id} - ${cashbill.customer}</span>
                            <span class="status-badge status-draft">Draft</span>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Date:</strong> ${cashbill.date}</p>
                                    <p><strong>Created by:</strong> ${cashbill.createdBy}</p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Total Amount:</strong> RM ${cashbill.totalAmount.toFixed(2)}</p>
                                    <p><strong>Items:</strong> ${itemsText}</p>
                                </div>
                            </div>
                            <div class="action-buttons mt-3">
                                <button class="btn btn-sm btn-primary view-uncommitted" data-id="${cashbill.id}">View Details</button>
                                <button class="btn btn-sm btn-success approve-uncommitted" data-id="${cashbill.id}">Approve</button>
                                <button class="btn btn-sm btn-danger reject-uncommitted" data-id="${cashbill.id}">Reject</button>
                            </div>
                        </div>
                    `;
                    
                    uncommittedList.appendChild(cardElement);
                });
                
                // Add event listeners to the buttons
                document.querySelectorAll('.view-uncommitted').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const cashbillId = this.getAttribute('data-id');
                        viewCashbillDetails(cashbillId);
                    });
                });
                
                document.querySelectorAll('.approve-uncommitted').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const cashbillId = this.getAttribute('data-id');
                        approveUncommittedCashbill(cashbillId);
                    });
                });
                
                document.querySelectorAll('.reject-uncommitted').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const cashbillId = this.getAttribute('data-id');
                        rejectUncommittedCashbill(cashbillId);
                    });
                });
            }
            
            // Approve uncommitted cashbill
            function approveUncommittedCashbill(cashbillId) {
                if (confirm(`Are you sure you want to approve cashbill ${cashbillId}?`)) {
                    // Find and remove the cashbill from uncommitted list
                    const index = uncommittedCashbills.findIndex(cb => cb.id === cashbillId);
                    if (index !== -1) {
                        uncommittedCashbills.splice(index, 1);
                        showToast(`Cashbill ${cashbillId} approved successfully!`, 'success');
                        refreshUncommittedList();
                        
                        // Update dashboard stats
                        const pendingCount = document.getElementById('pendingCashbills');
                        pendingCount.textContent = parseInt(pendingCount.textContent) - 1;
                        
                        const completedCount = document.getElementById('completedCashbills');
                        completedCount.textContent = parseInt(completedCount.textContent) + 1;
                    }
                }
            }
            
            // Reject uncommitted cashbill
            function rejectUncommittedCashbill(cashbillId) {
                if (confirm(`Are you sure you want to reject cashbill ${cashbillId}?`)) {
                    // Find and remove the cashbill from uncommitted list
                    const index = uncommittedCashbills.findIndex(cb => cb.id === cashbillId);
                    if (index !== -1) {
                        uncommittedCashbills.splice(index, 1);
                        showToast(`Cashbill ${cashbillId} rejected!`, 'warning');
                        refreshUncommittedList();
                        
                        // Update dashboard stats
                        const pendingCount = document.getElementById('pendingCashbills');
                        pendingCount.textContent = parseInt(pendingCount.textContent) - 1;
                    }
                }
            }
            
            // Generate report buttons
            document.querySelectorAll('.generate-report').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportType = this.getAttribute('data-type');
                    showToast(`Generating ${reportType} report...`, 'info');
                    
                    // In a real app, this would generate and download a report
                    setTimeout(() => {
                        showToast(`${reportType.charAt(0).toUpperCase() + reportType.slice(1)} report generated successfully!`, 'success');
                    }, 1500);
                });
            });
            
            // View all cashbills
            document.getElementById('viewCashbillListBtn').addEventListener('click', function() {
                showToast('Redirecting to cashbill list...', 'info');
                // In a real app, this would navigate to a list view
            });
            
            // View all logbooks
            document.getElementById('viewLogbookListBtn').addEventListener('click', function() {
                showToast('Redirecting to logbook list...', 'info');
                // In a real app, this would navigate to a list view
            });
            
            // Toast notification function
            function showToast(message, type = 'info') {
                const toastContainer = document.querySelector('.toast-container');
                
                const toast = document.createElement('div');
                toast.className = `toast align-items-center text-white bg-${type} border-0`;
                toast.setAttribute('role', 'alert');
                toast.setAttribute('aria-live', 'assertive');
                toast.setAttribute('aria-atomic', 'true');
                
                toast.innerHTML = `
                    <div class="d-flex">
                        <div class="toast-body">
                            ${message}
                        </div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                `;
                
                toastContainer.appendChild(toast);
                
                const bsToast = new bootstrap.Toast(toast, {
                    autohide: true,
                    delay: 3000
                });
                
                bsToast.show();
                
                // Remove toast element after it's hidden
                toast.addEventListener('hidden.bs.toast', function() {
                    toast.remove();
                });
            }
            
            // Initialize tooltips if needed
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        });
    </script>
</body>
</html>
